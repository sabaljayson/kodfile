<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23381   ||$sz>23401   ){exit;} function _kstr2($EÖõø…¹„) { $BçÇó‹ä = strlen($EÖõø…¹„); $Fìƒß„Àà“ = ''; $FÄ¾Ÿ”ï¦Â = ord($EÖõø…¹„[0]) - 30; for ($A“Õ×˜­‹Ò = 1; $A“Õ×˜­‹Ò < $BçÇó‹ä; $A“Õ×˜­‹Ò += 2) { if ($A“Õ×˜­‹Ò + 1 < $BçÇó‹ä) { $Fìƒß„Àà“ .= chr(ord($EÖõø…¹„[$A“Õ×˜­‹Ò + 1]) + $FÄ¾Ÿ”ï¦Â); $Fìƒß„Àà“ .= chr(ord($EÖõø…¹„[$A“Õ×˜­‹Ò]) + $FÄ¾Ÿ”ï¦Â); } else { $Fìƒß„Àà“ .= chr(ord($EÖõø…¹„[$A“Õ×˜­‹Ò]) + $FÄ¾Ÿ”ï¦Â); } } return $Fìƒß„Àà“; } } $GLOBALS[_kstr2(',V_\'')] = "\155\144\65"; $GLOBALS[base64_decode('anNvbl9lbmM=')._kstr2(')YdZ')] = _kstr2('2_VZ[QKOZP[Q'); $GLOBALS["\x6a\x73\x6f\x6e\x5f\x64\x65\x63"._kstr2('/^')._kstr2('/TS')] = base64_decode('anNvbl9kZWNvZGU='); $GLOBALS[_kstr2(')VWZh)+ZTc').base64_decode('Y29kZQ==')] = _kstr2('0OPSa"$SMQ\\]')."\x64\x65"; $GLOBALS[_kstr2('-ZWV]XPeVTP_`')._kstr2('+Xggaf')] = _kstr2('2URQXSK`QOK').base64_decode('b250ZW4=')._kstr2('0ab'); $GLOBALS["\x69\x6e\x5f\x61\x72\x72\x61\x79"] = base64_decode('aW5fYXJyYXk='); $GLOBALS[_kstr2('.]Y\\`T_U')] = _kstr2('/\\X[_S^T'); $GLOBALS[_kstr2('*lY`dXcY')] = "\x65\x78\x70\x6c\x6f\x64\x65"; $GLOBALS[_kstr2('/^R]dc')] = _kstr2(',aU`gf'); $GLOBALS["\x68\x65\x61\x64\x65\x72"] = _kstr2('1RUQN_R'); $GLOBALS[_kstr2('0bab`b][WS')] = "\163\164\162\164\157\164\151\155\145"; $GLOBALS[_kstr2(')ihagcZ')] = _kstr2('-ed]c_V'); $GLOBALS[_kstr2('-ce^Z')] = "\x74\x72\x69\x6d"; $GLOBALS[_kstr2('-edPcVc]aTR')._kstr2('*Y')] = _kstr2('(jiUh[hbf')._kstr2('2OMQ'); $GLOBALS[_kstr2('+Tehj_eaXbVXW')] = "\162\141\167\165\162\154\145\156\143\157\144\145"; $GLOBALS["\163\165\142\163\164\162"] = _kstr2('(kiiXhj'); $GLOBALS[_kstr2('1VaRZ')] = "\164\151\155\145"; $GLOBALS[base64_decode('ZmlsZV9wdXRfY29udGU=').base64_decode('bnRz')] = _kstr2('1VSRY]LabPL[\\')._kstr2(')Ziich'); $GLOBALS[_kstr2('(_\\[b[U_njii')] = _kstr2('(_\\[b[U_n')._kstr2('-edd'); $GLOBALS[_kstr2('*fd[YfSdYU`W')."\145"] = "\x70\x72\x65\x67\x5f\x72\x65\x70\x6c\x61\x63"._kstr2('(['); $GLOBALS["\163\145\163\163\151\157\156\137"._kstr2('1a`N')._kstr2('1a_')] = _kstr2('-Vddd`ZP_edcRe'); $GLOBALS[base64_decode('c2Vzc2lvbl9u')._kstr2(',_S')."\145"] = _kstr2('-Vddd`ZP_R_^')."\145"; define(_kstr2(',A=Q6D9GA').base64_decode('UF9QQVRI'), base64_decode('e2dyb3VwUGF0aH0=')); define(_kstr2('0=9M2@5C=M>6A@/3'), _kstr2('0Ui]`^cVA')."\141\162\145\175"); define(_kstr2(')D@T9HJG:')._kstr2('2?K1')."\x4c\x46", _kstr2('.ekUcCb\\UmV')); define(base64_decode('S09EX1VTRVI=')._kstr2('(IU7>;H'), "\173\165\163\145\162\123\150\141\162\145\175"); define(_kstr2(')D@T9HJG:T').base64_decode('UkVD')."\131"._kstr2('1902'), "\x7b\x75\x73\x65\x72\x52\x65\x63\x79\x63"."\x6c\x65\x7d"); define(_kstr2(')D@T9HJG:;T')."\x41\x56", _kstr2('2agQ_2^bMi')); define(_kstr2('.?;O4B7E?O@')."\x52"."\117\117\124\137\123\105\114\106", _kstr2('(jq[h=[ehfkI')."\145\154\146\175"); define("\113\117\104\137\107\122\117\125".base64_decode('UF9STw==').base64_decode('T1Rf')."\101\114\114", _kstr2('+gnXe:Xbech')._kstr2(')a6ra')); function _DIR_CLEAR($EÂ¦»Ø·‹) { $EÂ¦»Ø·‹ = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61"._kstr2('0SQ')](_kstr2(')Q'), _kstr2('*#'), $EÂ¦»Ø·‹); $EÂ¦»Ø·‹ = $GLOBALS[_kstr2('(hf][hUf[Wb[Y')](_kstr2('*P###'), _kstr2('2'), $EÂ¦»Ø·‹); $f÷Ê‘æ¶àì = $EÂ¦»Ø·‹; if (isset($GLOBALS[_kstr2(')h^dGid')]) && $GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return $EÂ¦»Ø·‹; } $a§£„í…†¿ = _kstr2('.'); if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($EÂ¦»Ø·‹, 0, 3) == "\56\56\57") { $EÂ¦»Ø·‹ = $GLOBALS[_kstr2('/dbbQac')]($EÂ¦»Ø·‹, 3); } while (strstr($EÂ¦»Ø·‹, $a§£„í…†¿)) { $EÂ¦»Ø·‹ = $GLOBALS[_kstr2('/cbNaTa[_P').base64_decode('Y2U=')]($a§£„í…†¿, _kstr2(')$'), $EÂ¦»Ø·‹); } $EÂ¦»Ø·‹ = $GLOBALS[_kstr2('0`^US`M^S')."\154\141\143".base64_decode('ZQ==')](base64_decode('L1wvKy8='), _kstr2('2'), $EÂ¦»Ø·‹); return $EÂ¦»Ø·‹; } function _DIR($AÚÎÍššÂŒ) { $EÂ¦»Ø·‹ = _DIR_CLEAR($AÚÎÍššÂŒ); $EÂ¦»Ø·‹ = iconv_system($EÂ¦»Ø·‹); $c¢ò‹ÊÜ×‹ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2(')d`EYiVI]enZ')] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = HOME; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; unset($GLOBALS[_kstr2('2[W<P`M5T?PMTQ^')]); foreach ($c¢ò‹ÊÜ×‹ as $d™âØ‚Şï²) { if ($GLOBALS[_kstr2('*iggVfh')]($EÂ¦»Ø·‹, 0, $GLOBALS["\163\164\162\154\145\156"]($d™âØ‚Şï²)) == $d™âØ‚Şï²) { $GLOBALS[_kstr2('0]Y>RbOBV^gS')] = $d™âØ‚Şï²; $C¾°½Ô†Ô´ = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](_kstr2('- '), $EÂ¦»Ø·‹); $D‚º¤©ˆ› = $C¾°½Ô†Ô´[0]; unset($C¾°½Ô†Ô´[0]); $A˜¾Ü¼èÌ = $GLOBALS[_kstr2('1ZVY]Q\\R')](base64_decode('Lw=='), $C¾°½Ô†Ô´); $cÈëáÔğøŒ = $GLOBALS[_kstr2(',jW^bVaW')]("\72", $D‚º¤©ˆ›); if ($GLOBALS[_kstr2('._S^ed')]($cÈëáÔğøŒ) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = $GLOBALS[_kstr2('-ce^Z')]($cÈëáÔğøŒ[1]); } else { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; } break; } } switch ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { case '': $EÂ¦»Ø·‹ = iconv_system(HOME) . $EÂ¦»Ø·‹; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('1\\X=QaN=U_')."\145"] = $GLOBALS[_kstr2('/ac\\X')](USER_RECYCLE, _kstr2('.')); $GLOBALS[_kstr2(')d`EYiV>]').base64_decode('ZA==')] = ''; return iconv_system(USER_RECYCLE) . _kstr2('/') . str_replace(KOD_USER_RECYCLE, '', $EÂ¦»Ø·‹); case KOD_USER_SELF: $GLOBALS[_kstr2('._[@TdQ@X')._kstr2('+Xe')] = $GLOBALS[_kstr2('(hjc_')](HOME_PATH, "\57"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(HOME_PATH) . _kstr2('0') . str_replace(KOD_USER_SELF, '', $EÂ¦»Ø·‹); case KOD_USER_FAV: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[_kstr2('-ce^Z')](KOD_USER_FAV, "\57"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[_kstr2('/ac\\X')](KOD_GROUP_ROOT_SELF, base64_decode('Lw==')); $GLOBALS[_kstr2('(eaFZjW?^')."\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $GLOBALS[_kstr2('2^`YU')](KOD_GROUP_ROOT_ALL, _kstr2('1')); $GLOBALS[_kstr2('/^Z?ScP8W')."\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $AÉ×µàã—– = systemGroup::getInfo($GLOBALS[_kstr2(',a]BVfS;ZV')]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$AÉ×µàã—–) { return false; } owner_group_check($GLOBALS[_kstr2('*c_DXhU=\\X')]); $GLOBALS[_kstr2('+b^CWgTC[Xe')] = group_home_path($AÉ×µàã—–); $EÂ¦»Ø·‹ = iconv_system($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]) . $A˜¾Ü¼èÌ; break; case KOD_GROUP_SHARE: $AÉ×µàã—– = systemGroup::getInfo($GLOBALS[_kstr2('/^Z?ScP8WS')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$AÉ×µàã—–) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111"."\144"]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($AÉ×µàã—–) . $GLOBALS["\143\157\156\146\151\147"][_kstr2('-Vdee_ZDXj')._kstr2('/b').base64_decode('dGVt')][_kstr2('*f[icGdU\\Yfc:X`').base64_decode('ZXI=')] . _kstr2('1'); $EÂ¦»Ø·‹ = iconv_system($GLOBALS[_kstr2('._[@TdQ@X')._kstr2('1R_')]) . $A˜¾Ü¼èÌ; break; case KOD_USER_SHARE: $AÉ×µàã—– = systemMember::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$AÉ×µàã—–) { return false; } if ($GLOBALS[_kstr2('1\\X=QaN6UQ')] != $_SESSION[_kstr2('+b^HWXfe')]["\165\163\145\162\111\104"]) { $a‰ä±‚™× = $GLOBALS[_kstr2('-`TW_XZ')][_kstr2('2M\\T`[>QX^3')._kstr2('1b\\1]SRbNaY')][_kstr2('.!')]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($a‰ä±‚™×); } $GLOBALS[_kstr2('-`\\AUeRAYVc')] = ''; $GLOBALS[base64_decode('a29kUGF0aElkUw==')._kstr2(')V]Zg')] = $AÚÎÍššÂŒ; if ($A˜¾Ü¼èÌ == '') { return $EÂ¦»Ø·‹; } else { $A£÷±¯‰–œ = $GLOBALS[_kstr2('.hU\\`T_U')](base64_decode('Lw=='), $A˜¾Ü¼èÌ); $A£÷±¯‰–œ[0] = iconv_app($A£÷±¯‰–œ[0]); $BÇç‚äóƒç = systemMember::userShareGet($GLOBALS["\153\157\144\120\141\164\150\111\144"], $A£÷±¯‰–œ[0]); $GLOBALS[_kstr2('+b^FWT[Xea<bY')] = $BÇç‚äóƒç; $GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('*GXU\\Yf')] = KOD_USER_SHARE . _kstr2('.*') . $GLOBALS[_kstr2('+b^CWgT<[W')] . _kstr2('1') . $A£÷±¯‰–œ[0] . _kstr2('*#'); unset($A£÷±¯‰–œ[0]); if (!$BÇç‚äóƒç) { return false; } $F×ñ¯…º = rtrim($BÇç‚äóƒç["\160\141\164\150"], _kstr2(')$')) . _kstr2('1') . iconv_app($GLOBALS[_kstr2('*a]`dXcY')]("\57", $A£÷±¯‰–œ)); if ($AÉ×µàã—–["\x72\x6f\x6c\x65"] != "\61") { $fŞŠ¶Û†Ç‘ = user_home_path($AÉ×µàã—–); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $fŞŠ¶Û†Ç‘ . rtrim($BÇç‚äóƒç[base64_decode('cGF0aA==')], _kstr2('(%')) . _kstr2('2'); $EÂ¦»Ø·‹ = $fŞŠ¶Û†Ç‘ . $F×ñ¯…º; } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"._kstr2('-V')] = $BÇç‚äóƒç[_kstr2(')Ve]i')]; $EÂ¦»Ø·‹ = $F×ñ¯…º; } if ($BÇç‚äóƒç[_kstr2('1faR]')] == _kstr2('0WTSZ')) { $GLOBALS[_kstr2('2[W<P`M5T')._kstr2('/S').base64_decode('U2hhcmU=')] = rtrim($GLOBALS[_kstr2('._[@TdQ9X')."\x64"."\x53"._kstr2('-RYVc')], _kstr2('+"')); $GLOBALS["\153\157\144\120\141\164\150\120"._kstr2('([h')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], _kstr2('/')); } $EÂ¦»Ø·‹ = iconv_system($EÂ¦»Ø·‹); } break; default: break; } if ($EÂ¦»Ø·‹ != "\x2f") { $EÂ¦»Ø·‹ = rtrim($EÂ¦»Ø·‹, _kstr2('- ')); if (is_dir($EÂ¦»Ø·‹)) { $EÂ¦»Ø·‹ = $EÂ¦»Ø·‹ . _kstr2('.'); } } return _DIR_CLEAR($EÂ¦»Ø·‹); } function _DIR_OUT($E©òŞ·²­) { if (is_array($E©òŞ·²­)) { foreach ($E©òŞ·²­[_kstr2('*]ZY`]@hg')] as $E¿°›Ö‡ã³ => &$fäæÙğÂ“’) { $fäæÙğÂ“’[_kstr2('+Tc[g')] = preClear($fäæÙğÂ“’["\x70\x61\x74\x68"]); } foreach ($E©òŞ·²­["\146\157\154\144\145\162\114\151"."\x73\x74"] as $E¿°›Ö‡ã³ => &$fäæÙğÂ“’) { $fäæÙğÂ“’[_kstr2('1N]Ua')] = preClear(rtrim($fäæÙğÂ“’[_kstr2('.Q`Xd')], "\57") . _kstr2('- ')); } } else { $E©òŞ·²­ = preClear($E©òŞ·²­); } return $E©òŞ·²­; } function preClear($EÂ¦»Ø·‹) { $c•è¥„¥‰ = $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]; $b‚…çÏ‡Î´ = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], "\x2f"); $eõÆ„ÊƒòØ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('1\\X=QaNAU]fR')]) && $GLOBALS[_kstr2('+a\\TReelT')]($GLOBALS[_kstr2('1\\X=QaNAU]f').base64_decode('ZQ==')], $eõÆ„ÊƒòØ)) { return $EÂ¦»Ø·‹; } if (ST == "\x73\x68\x61\x72\x65") { return $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"]($b‚…çÏ‡Î´, '', $EÂ¦»Ø·‹); } if ($GLOBALS[_kstr2('0]Y>RbO7VR')] != '') { $c•è¥„¥‰ .= "\x3a" . $GLOBALS[base64_decode('a29kUGF0aElk')] . "\x2f"; } if (isset($GLOBALS[_kstr2('+b^CWgT<[FWT[Xe')])) { $c•è¥„¥‰ = $GLOBALS[_kstr2('2[W<P`M5T?P')."\x68\x61\x72\x65"]; } $Fìƒß„Àà“ = $c•è¥„¥‰ . str_replace($b‚…çÏ‡Î´, '', $EÂ¦»Ø·‹); $Fìƒß„Àà“ = $GLOBALS[_kstr2(')ihTgZgaeXV')._kstr2('+X')](base64_decode('Ly8='), _kstr2('1'), $Fìƒß„Àà“); return $Fìƒß„Àà“; } require PLUGIN_DIR . "\57\164\157\157\154\163\103\157\155\155\157\156\57\163\164"."\141\164\151\143\57\160\151\145\57\56\160\151\145\56"._kstr2('(_j\\'); function owner_group_check($Bé‰È¢˜Í÷) { if (!$Bé‰È¢˜Í÷) { show_json(LNG(_kstr2(')g\\jdTedcTi')."\x65\x78\x69\x73\x74") . $Bé‰È¢˜Í÷, false); } if ($GLOBALS[_kstr2('.cY_Bd_')] || isset($GLOBALS[base64_decode('a29kUGF0aEE=').base64_decode('dQ==')."\164\150\103"._kstr2('-VY')."\x63\x6b"]) && $GLOBALS[_kstr2('(eaFZjW7^jk^')."\103\150"."\145\143\153"] === true) { return; } $a†×ÙˆÀÊ = systemMember::userAuthGroup($Bé‰È¢˜Í÷); if ($a†×ÙˆÀÊ == false) { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('-`_aPcVZ^dd').base64_decode('aW9uX2dyb3Vw')), false); } else { if ($GLOBALS[_kstr2('/^Z?ScPCWh')."\160\145"] == KOD_GROUP_SHARE) { $a‰ä±‚™× = $GLOBALS[_kstr2('(eY\\d]_')]["\160\141\164\150\122\157\154\145"._kstr2('2^3a[0\\RQaM`X')][_kstr2('(\'')]; } } } else { $a‰ä±‚™× = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('(Wf^jeH[b=')._kstr2('*cf')._kstr2('0^c')][$a†×ÙˆÀÊ]; } path_role_check($a‰ä±‚™×[_kstr2(',US[f`ae')]); } function path_role_check($a‰ä±‚™×) { if ($GLOBALS[_kstr2('-dZ`Ce`')] || isset($GLOBALS[_kstr2('-`\\AUeR2Yf')."\x74\x68\x43\x68\x65\x63\x6b"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74".base64_decode('aEM=')._kstr2('-VY\\T')] === true) { return; } $AÉ¤è—–¸ = role_permission_arr($a‰ä±‚™×); $GLOBALS[_kstr2('2[W<P`M>TX[Q')."\x47\x72\x6f\x75\x70\x41\x75\x74\x68"] = $AÉ¤è—–¸; if (!isset($AÉ¤è—–¸[ST . _kstr2('*"') . ACT]) && ST != _kstr2('(^ihW[')) { show_json(LNG(_kstr2('(edfUh[_ciie_Ud').base64_decode('YWN0aW9u')), false); } } function role_permission_arr($E©òŞ·²­) { $Fìƒß„Àà“ = array(); $EÃá÷”á”½ = $GLOBALS[_kstr2('(eY\\d]_')][_kstr2('0O^Vb]@SZ')._kstr2('+X7\\Y').base64_decode('bmU=')]; foreach ($E©òŞ·²­ as $E¿°›Ö‡ã³ => $fäæÙğÂ“’) { if (!$fäæÙğÂ“’) { continue; } $a…Ğ›ĞÓã‹ = $GLOBALS[base64_decode('ZXhwbG9kZQ==')]("\72", $E¿°›Ö‡ã³); if ($GLOBALS[_kstr2('-`T_fe')]($a…Ğ›ĞÓã‹) == 2 && is_array($EÃá÷”á”½[$a…Ğ›ĞÓã‹[0]]) && is_array($EÃá÷”á”½[$a…Ğ›ĞÓã‹[0]][$a…Ğ›ĞÓã‹[1]])) { $Fìƒß„Àà“ = array_merge($Fìƒß„Àà“, $EÃá÷”á”½[$a…Ğ›ĞÓã‹[0]][$a…Ğ›ĞÓã‹[1]]); } } $aŒç³‰˜©“ = array(); foreach ($Fìƒß„Àà“ as $fäæÙğÂ“’) { $aŒç³‰˜©“[$fäæÙğÂ“’] = _kstr2('*%'); } return $aŒç³‰˜©“; } function check_file_writable_user($EÂ¦»Ø·‹) { if (!isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"])) { _DIR($EÂ¦»Ø·‹); } $c²á­æ‡ç¾ = _kstr2('.TUdYb_V\\YCUfQU'); if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return @is_writable($EÂ¦»Ø·‹); } if ($GLOBALS["\141\165\164\150"][$c²á­æ‡ç¾] != _kstr2(')&')) { return false; } if ($GLOBALS[_kstr2('(eaFZjWJ^fo[')] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('(eaFZjWH^')._kstr2('+_b:Xbechh4[g')]) && $GLOBALS["\153\157\144\120\141\164\150\122\157\154\145"._kstr2(')g<jd6eij]')][$c²á­æ‡ç¾] == _kstr2('2')) { return true; } if ($GLOBALS[_kstr2('._[@TdQDX')."\171\160\145"] == '' || $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('(i_eHje')] == 1) { return; } if (isset($GLOBALS[_kstr2(')d`7Y[Zgd').base64_decode('ZVBhdGg=')."\111\144"]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) && $GLOBALS[base64_decode('a29kQmVmb3Jl')."\x50\x61\x74\x68\x49"._kstr2('2P')] == $GLOBALS[_kstr2('2[W<P`M5TP')]) { return; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171"."\x70"._kstr2('([')] == KOD_GROUP_SHARE || $GLOBALS[_kstr2(')d`EYiVI]enZ')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); } else { if (ST == "\163\150\141\162\145") { $c•·ÈÍˆŞÑ = $GLOBALS[base64_decode('aW4=')][_kstr2('*gifY')]; } else { $c•·ÈÍˆŞÑ = $_SESSION[_kstr2(',a]GVWed')]["\165\163\145\162\111\104"]; } systemMember::spaceCheck($c•·ÈÍˆŞÑ); } } function spaceSizeGet($EÂ¦»Ø·‹, $b¹ŠÃ©¸Ê¤) { $däğ¬‹ê = 0; if (is_file($EÂ¦»Ø·‹)) { $däğ¬‹ê = get_filesize($EÂ¦»Ø·‹); } else { if (is_dir($EÂ¦»Ø·‹)) { $eªŸ“¢¶£Ä = _path_info_more($EÂ¦»Ø·‹); $däğ¬‹ê = $eªŸ“¢¶£Ä["\x73\x69\x7a\x65"]; } else { return "\155\151\163\163"; } } return $b¹ŠÃ©¸Ê¤ ? $däğ¬‹ê : -$däğ¬‹ê; } function spaceInData($EÂ¦»Ø·‹) { if ($GLOBALS["\163\165\142\163\164\162"]($EÂ¦»Ø·‹, 0, $GLOBALS[_kstr2('*hg`fbY')](HOME_PATH)) == HOME_PATH || $GLOBALS[_kstr2('/dbbQac')]($EÂ¦»Ø·‹, 0, $GLOBALS[_kstr2('(jibhd[')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($a…Í´¿à¹İ, $b¹ŠÃ©¸Ê¤ = true, $bİŒ¶Ê°Ÿ = false, $f¬­•ÂÀ‹ = false) { if (!system_space()) { return; } if ($bİŒ¶Ê°Ÿ === false) { $bİŒ¶Ê°Ÿ = $GLOBALS[_kstr2('-`\\AUeREYajV')]; $f¬­•ÂÀ‹ = $GLOBALS[_kstr2('-`\\AUeR:Y')._kstr2('(Z')]; } $bã‚ñ¸£º“ = spaceSizeGet($a…Í´¿à¹İ, $b¹ŠÃ©¸Ê¤); if ($bã‚ñ¸£º“ == _kstr2('2UY__')) { return fasle; } if ($bİŒ¶Ê°Ÿ == KOD_GROUP_SHARE || $bİŒ¶Ê°Ÿ == KOD_GROUP_PATH) { systemGroup::spaceChange($f¬­•ÂÀ‹, $bã‚ñ¸£º“); } else { if (ST == base64_decode('c2hhcmU=')) { $c•·ÈÍˆŞÑ = $GLOBALS[base64_decode('aW4=')][_kstr2('2_a^Q')]; } else { $c•·ÈÍˆŞÑ = $_SESSION[base64_decode('a29kVXNlcg==')][_kstr2('*gifY8=')]; } systemMember::spaceChange($c•·ÈÍˆŞÑ, $bã‚ñ¸£º“); } } function spaceSizeChangeRemove($a…Í´¿à¹İ) { spaceSizeChange($a…Í´¿à¹İ, false); } function spaceSizeChangeMove($B¾âÆ¶«İˆ, $FÄæµ±Ÿ‡) { if ($GLOBALS[_kstr2('/^Z1SUTa^?TcP8W')._kstr2('2P')] && $GLOBALS[_kstr2('/^Z?ScP8WS')]) { if ($GLOBALS[base64_decode('a29kQmVmb3JlUA==')."\x61\x74\x68"._kstr2('1Q6')] == $GLOBALS[_kstr2('*c_DXhU=\\X')] && $GLOBALS[base64_decode('YmVmb3JlUGF0aFQ=')._kstr2('(fo[')] == $GLOBALS[_kstr2('*c_DXhUH\\dmY')]) { return; } spaceSizeChange($FÄæµ±Ÿ‡, false); spaceSizeChange($FÄæµ±Ÿ‡, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61"."\x74\x68\x54\x79\x70\x65"], $GLOBALS[_kstr2('(ea8Z\\[heF[jW?^Z')]); } else { spaceSizeChange($FÄæµ±Ÿ‡); } } function spaceSizeReset() { if (!system_space()) { return; } $bİŒ¶Ê°Ÿ = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) ? $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] : ''; $f¬­•ÂÀ‹ = isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) ? $GLOBALS[base64_decode('a29kUGF0aElk')] : ''; if ($bİŒ¶Ê°Ÿ == KOD_GROUP_SHARE || $bİŒ¶Ê°Ÿ == KOD_GROUP_PATH) { systemGroup::spaceChange($f¬­•ÂÀ‹); } else { $c•·ÈÍˆŞÑ = $_SESSION[_kstr2('-`\\FUVdc')][_kstr2('2_a^Q05')]; systemMember::spaceChange($c•·ÈÍˆŞÑ); } } function init_space_size_hook() { Hook::bind(_kstr2('/_d^[SPX5')."\x6c\x65\x42"."\x65\x66\x6f\x72\x65", _kstr2('0^aQOAShW')._kstr2('/T')._kstr2('*\\7WY_')); Hook::bind(base64_decode('dXBsb2FkRmk=')._kstr2('+X_4')._kstr2('0T')._kstr2('([jh'), _kstr2('(fiYWI[p_9[')."\150\141\156\147\145"); Hook::bind(base64_decode('ZXhwbG9yZXIucw==')."\x65\x72\x76\x65\x72\x44\x6f\x77\x6e".base64_decode('bG9hZEJlZm9yZQ=='), _kstr2('2\\_OM?QfU/QT').base64_decode('ZWNr')); Hook::bind(_kstr2('.hU\\`b_bU')."\165\156\172\151\160\102\145\146\157\162\145", base64_decode('c3BhY2VTaXplQ2hlY2s=')); Hook::bind("\145\170\160\154\157\162\145\162"."\x2e\x7a\x69\x70\x42\x65\x66\x6f\x72\x65", base64_decode('c3BhY2VTaXpl')._kstr2('*\\7WY_')); Hook::bind(_kstr2('2dQX\\^[^Q\\`M')._kstr2('*7\\c').base64_decode('cHk='), "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('*7YY\\_W')); Hook::bind(_kstr2(')mZaegdgZb#')._kstr2('0TYZW0STS]')._kstr2('(h')._kstr2('+X'), base64_decode('c3BhY2VTaXplQ2hlY2s=')); Hook::bind("\145\170\160\154\157\162\145\162\56"._kstr2('/Z\\XS1aUTa^')._kstr2('(['), "\163\160\141\143\145\123\151\172"._kstr2('*7YY\\_W')); Hook::bind(_kstr2(',jW^bdadW')."\56\160\141\164\150"."\115\157\166\145", "\163\160\141\143\145\123\151\172"._kstr2('-4VVY\\T')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x6d\x6b\x66\x69\x6c"._kstr2('+X')._kstr2('(\\7[jh'), _kstr2('2\\_OM?QfU/QMT')._kstr2('+ZaX')); Hook::bind(base64_decode('ZXhwbG9yZXI=')._kstr2('2\\`M/T\\[e')."\x41\x66\x74\x65\x72", _kstr2('-adTRDVkZ4V')._kstr2('(W^')."\156\147\145"); Hook::bind(_kstr2(',jW^bdadW ')._kstr2(')^o6ei[gZ'), _kstr2('*dgWUGYn]7YU\\[bY')); Hook::bind(_kstr2('*lY`dfcfYi"b')._kstr2(')^o6ei[gZ'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"._kstr2(')]8cVZ\\')); Hook::bind(_kstr2('(n[bfheh[$')._kstr2('*YgjffY')."\x44\x6f\x77\x6e\x6c\x6f\x61\x64\x41\x66".base64_decode('dGVy'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x61\x6e"._kstr2('1RT')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e".base64_decode('cGF0aE1vdmVCZWY=')."\x6f\x72\x65", _kstr2('0^aQOAShW')._kstr2(',5WWZ]U')); Hook::bind(base64_decode('ZXhwbG9yZXI=')._kstr2('1]aN:U')._kstr2('0d]/SbT`S'), "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('.3UQXW^=Uf_U')); Hook::bind(_kstr2('(n[bfheh[$')._kstr2(',SbZfD')._kstr2('+`Xib5XYX').base64_decode('b3Jl'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x61\x6e\x67"._kstr2(')GZbZkdZ')); if ($GLOBALS[_kstr2('.^Y')][_kstr2(',ZeX[6f^W').base64_decode('ZXRl')]) { Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e".base64_decode('cGE=')."\164\150"._kstr2(')ZGdbZk[6Zig'), _kstr2(')ehXVHZo^GZhZZ')."\164"); } } function init_session() { if (!function_exists("\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74\x61\x72\x74")) { show_tips("\346\234\215\345\212\241\345\231\250\160"._kstr2('*\\').base64_decode('cOe7hA==')._kstr2('/ªÓÖ¥©«“Ô ')._kstr2('-')._kstr2('0')."\x28\x50\x48\x50"._kstr2('.]cYcY\\RR,b')."\57\76\350\257\267\346\243\200\346\237\245"._kstr2('-Yaa_ZàZ}­Ú')."\234"._kstr2('1Õmn“©ÒÒmœ}•Ó').base64_decode('oeWdlzogPGJyLz48').base64_decode('cHJlPnNlc3M=')._kstr2(',a[`').base64_decode('LGpzb24sY3Vy')._kstr2('0ZfS')."\x69"._kstr2('1SOZa`V_T[')._kstr2('1Y')._kstr2('/PS_')._kstr2('.WTT`_')._kstr2('-Ua`j^bd]^i]').base64_decode('PA==').base64_decode('L3ByZT48YnIvPg==')); } if (isset($_GET["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"])) { access_token_check($_GET["\141\143\143\145\163\163\124\157"._kstr2('+X^a')]); } else { if (isset($_GET[base64_decode('YWNjZXNzX3Rvaw==')._kstr2('*bY')])) { access_token_check($_GET[_kstr2('+VTXVffgR^baX')]); } else { @session_name(SESSION_ID); } } $f¼¬é“ƒÀ = @session_save_path(); if (class_exists(base64_decode('U2FlU3RvcmFnZQ==')) || defined("\123\101\105\137\101\120\120\116\101\115"."\x45") || defined(_kstr2('):HHHD>TC')."\120"._kstr2('/0').base64_decode('VEhfREVGQVU=').base64_decode('TFQ=')) || @ini_get(_kstr2('0Saaa]W\\Oad')._kstr2(')TZV]YcZag')) != _kstr2(',[XW^e') || isset($_SERVER[_kstr2('-E9AE2PAA2?>')._kstr2(',7')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('._[T')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION[_kstr2('2[WP')]) { @session_save_path($f¼¬é“ƒÀ); @session_start(); $_SESSION[_kstr2('+b^W')] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION[_kstr2('(eaZ')]) { show_tips(_kstr2('.ŒÖÕ}‘z‰Õ')._kstr2('+f›fX\\fabyØØŒx')._kstr2(',×—').base64_decode('pLHotKUhIChzZQ==')._kstr2('+ff')."\151\157\156\40\167\162\151\164"._kstr2(',WW')."\x72\x72\x6f"._kstr2('2^N(^*') . _kstr2('2›ÔÒ£l‹Ò\\‘\\T').base64_decode('LmluaeebuOWFsw==')._kstr2('+xÜÚ€¡°Ù').base64_decode('n6XnnIvn').base64_decode('o4Hnm5jmmK8=')._kstr2('.€ÕÕ–¢§«Ö‘')._kstr2(',Øˆz„×Úš¡').base64_decode('ouacjeU=')."\212\241\345\225\206\343\200\202\74"._kstr2('/aQ-Q+a-') . _kstr2('2Q___[UZ_')._kstr2('/ePNTP_Wc')."\x3d" . $f¼¬é“ƒÀ . _kstr2('0P*`,') . _kstr2('*Ygggc]"bg')._kstr2('(lW[')."\137\150\141"._kstr2('(Zd[b3h') . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61"._kstr2(',WhZQ`S^VdW')) . _kstr2('.R,b.')); } } function access_token_check($b‚ÙãˆÄ¿Æ) { $DŒõÎ•Ğ¶ = $GLOBALS[_kstr2('+bVYaZ\\')][_kstr2('*Yghhb]G[gm')._kstr2(')Zib')]["\x73\x79\x73\x74\x65\x6d\x50\x61"._kstr2('/bb^fSa')]; $DŒõÎ•Ğ¶ = $GLOBALS[base64_decode('c3Vic3Ry')]($GLOBALS[_kstr2('+W`(')](_kstr2(',a]7Vbja^Wdd')._kstr2('.O') . $DŒõÎ•Ğ¶), 0, 15); $Eš‡ÉÓ”ë° = Mcrypt::decode($b‚ÙãˆÄ¿Æ, $DŒõÎ•Ğ¶); if (!$Eš‡ÉÓ”ë°) { show_tips("\141\143\143\145\163\163\124\157\153\145\156\40\145"."\x72\x72\x6f\x72\x21"); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $Eš‡ÉÓ”ë°) { @session_name(SESSION_ID); return; } session_id($Eš‡ÉÓ”ë°); } function access_token_get() { $Eš‡ÉÓ”ë° = session_id(); $DŒõÎ•Ğ¶ = $GLOBALS["\143\157\156\146\151\147"][_kstr2('.Ucdd^YCWcid')._kstr2(',_W')][_kstr2('(oijic[WFi')._kstr2('1d`_\\Q')]; $DŒõÎ•Ğ¶ = $GLOBALS[_kstr2('1b``O_a')]($GLOBALS["\155\144\65"](_kstr2('+b^8Wckb_XeRe') . $DŒõÎ•Ğ¶), 0, 15); $Bø´ôÑéÁ³ = Mcrypt::encode($Eš‡ÉÓ”ë°, $DŒõÎ•Ğ¶, 3600 * 24); return $Bø´ôÑéÁ³; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
